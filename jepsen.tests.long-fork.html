<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>jepsen.tests.long-fork documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Jepsen</span> <span class="project-version">0.3.7</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>jepsen</span></div></div></li><li class="depth-2 branch"><a href="jepsen.adya.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>adya</span></div></a></li><li class="depth-2"><a href="jepsen.checker.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>checker</span></div></a></li><li class="depth-3 branch"><a href="jepsen.checker.clock.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>clock</span></div></a></li><li class="depth-3 branch"><a href="jepsen.checker.perf.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>perf</span></div></a></li><li class="depth-3"><a href="jepsen.checker.timeline.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>timeline</span></div></a></li><li class="depth-2 branch"><a href="jepsen.cli.html"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>cli</span></div></a></li><li class="depth-2 branch"><a href="jepsen.client.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>client</span></div></a></li><li class="depth-2 branch"><a href="jepsen.codec.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>codec</span></div></a></li><li class="depth-2"><a href="jepsen.control.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>control</span></div></a></li><li class="depth-3 branch"><a href="jepsen.control.clj-ssh.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>clj-ssh</span></div></a></li><li class="depth-3 branch"><a href="jepsen.control.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3 branch"><a href="jepsen.control.docker.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>docker</span></div></a></li><li class="depth-3 branch"><a href="jepsen.control.k8s.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>k8s</span></div></a></li><li class="depth-3 branch"><a href="jepsen.control.net.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>net</span></div></a></li><li class="depth-3 branch"><a href="jepsen.control.retry.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>retry</span></div></a></li><li class="depth-3 branch"><a href="jepsen.control.scp.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>scp</span></div></a></li><li class="depth-3 branch"><a href="jepsen.control.sshj.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sshj</span></div></a></li><li class="depth-3"><a href="jepsen.control.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2 branch"><a href="jepsen.core.html"><div class="inner"><span class="tree" style="top: -300px;"><span class="top" style="height: 309px;"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="jepsen.db.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>db</span></div></a></li><li class="depth-2 branch"><a href="jepsen.faketime.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>faketime</span></div></a></li><li class="depth-2 branch"><a href="jepsen.fs-cache.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fs-cache</span></div></a></li><li class="depth-2"><a href="jepsen.generator.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>generator</span></div></a></li><li class="depth-3 branch"><a href="jepsen.generator.context.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>context</span></div></a></li><li class="depth-3 branch"><a href="jepsen.generator.interpreter.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interpreter</span></div></a></li><li class="depth-3 branch"><a href="jepsen.generator.test.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>test</span></div></a></li><li class="depth-3"><a href="jepsen.generator.translation-table.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>translation-table</span></div></a></li><li class="depth-2 branch"><a href="jepsen.independent.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>independent</span></div></a></li><li class="depth-2 branch"><a href="jepsen.lazyfs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lazyfs</span></div></a></li><li class="depth-2"><a href="jepsen.nemesis.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>nemesis</span></div></a></li><li class="depth-3 branch"><a href="jepsen.nemesis.combined.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>combined</span></div></a></li><li class="depth-3"><a href="jepsen.nemesis.membership.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>membership</span></div></a></li><li class="depth-4"><a href="jepsen.nemesis.membership.state.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>state</span></div></a></li><li class="depth-3"><a href="jepsen.nemesis.time.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>time</span></div></a></li><li class="depth-2"><a href="jepsen.net.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>net</span></div></a></li><li class="depth-3"><a href="jepsen.net.proto.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>proto</span></div></a></li><li class="depth-2"><a href="jepsen.os.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>os</span></div></a></li><li class="depth-3 branch"><a href="jepsen.os.centos.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>centos</span></div></a></li><li class="depth-3 branch"><a href="jepsen.os.debian.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>debian</span></div></a></li><li class="depth-3 branch"><a href="jepsen.os.smartos.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>smartos</span></div></a></li><li class="depth-3"><a href="jepsen.os.ubuntu.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ubuntu</span></div></a></li><li class="depth-2 branch"><a href="jepsen.reconnect.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>reconnect</span></div></a></li><li class="depth-2 branch"><a href="jepsen.repl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>repl</span></div></a></li><li class="depth-2 branch"><a href="jepsen.report.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>report</span></div></a></li><li class="depth-2 branch"><a href="jepsen.role.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>role</span></div></a></li><li class="depth-2"><a href="jepsen.store.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>store</span></div></a></li><li class="depth-3 branch"><a href="jepsen.store.format.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>format</span></div></a></li><li class="depth-3"><a href="jepsen.store.fressian.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fressian</span></div></a></li><li class="depth-2"><a href="jepsen.tests.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>tests</span></div></a></li><li class="depth-3 branch"><a href="jepsen.tests.adya.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>adya</span></div></a></li><li class="depth-3 branch"><a href="jepsen.tests.bank.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bank</span></div></a></li><li class="depth-3 branch"><a href="jepsen.tests.causal.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>causal</span></div></a></li><li class="depth-3 branch"><a href="jepsen.tests.causal-reverse.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>causal-reverse</span></div></a></li><li class="depth-3"><a href="jepsen.tests.cycle.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cycle</span></div></a></li><li class="depth-4 branch"><a href="jepsen.tests.cycle.append.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>append</span></div></a></li><li class="depth-4"><a href="jepsen.tests.cycle.wr.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>wr</span></div></a></li><li class="depth-3 branch"><a href="jepsen.tests.kafka.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>kafka</span></div></a></li><li class="depth-3 branch"><a href="jepsen.tests.linearizable-register.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>linearizable-register</span></div></a></li><li class="depth-3 current"><a href="jepsen.tests.long-fork.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>long-fork</span></div></a></li><li class="depth-2 branch"><a href="jepsen.util.html"><div class="inner"><span class="tree" style="top: -331px;"><span class="top" style="height: 340px;"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2"><a href="jepsen.web.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>web</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="jepsen.tests.long-fork.html#var-checker"><div class="inner"><span>checker</span></div></a></li><li class="depth-1"><a href="jepsen.tests.long-fork.html#var-distinct-pairs"><div class="inner"><span>distinct-pairs</span></div></a></li><li class="depth-1"><a href="jepsen.tests.long-fork.html#var-early-reads"><div class="inner"><span>early-reads</span></div></a></li><li class="depth-1"><a href="jepsen.tests.long-fork.html#var-ensure-no-long-forks"><div class="inner"><span>ensure-no-long-forks</span></div></a></li><li class="depth-1"><a href="jepsen.tests.long-fork.html#var-ensure-no-multiple-writes-to-one-key"><div class="inner"><span>ensure-no-multiple-writes-to-one-key</span></div></a></li><li class="depth-1"><a href="jepsen.tests.long-fork.html#var-find-forks"><div class="inner"><span>find-forks</span></div></a></li><li class="depth-1"><a href="jepsen.tests.long-fork.html#var-generator"><div class="inner"><span>generator</span></div></a></li><li class="depth-1"><a href="jepsen.tests.long-fork.html#var-group-for"><div class="inner"><span>group-for</span></div></a></li><li class="depth-1"><a href="jepsen.tests.long-fork.html#var-groups"><div class="inner"><span>groups</span></div></a></li><li class="depth-1"><a href="jepsen.tests.long-fork.html#var-late-reads"><div class="inner"><span>late-reads</span></div></a></li><li class="depth-1"><a href="jepsen.tests.long-fork.html#var-legal-txn.3F"><div class="inner"><span>legal-txn?</span></div></a></li><li class="depth-1"><a href="jepsen.tests.long-fork.html#var-op-read-keys"><div class="inner"><span>op-read-keys</span></div></a></li><li class="depth-1"><a href="jepsen.tests.long-fork.html#var-read-compare"><div class="inner"><span>read-compare</span></div></a></li><li class="depth-1"><a href="jepsen.tests.long-fork.html#var-read-op-.3Evalue-map"><div class="inner"><span>read-op-&gt;value-map</span></div></a></li><li class="depth-1"><a href="jepsen.tests.long-fork.html#var-read-txn-for"><div class="inner"><span>read-txn-for</span></div></a></li><li class="depth-1"><a href="jepsen.tests.long-fork.html#var-read-txn.3F"><div class="inner"><span>read-txn?</span></div></a></li><li class="depth-1"><a href="jepsen.tests.long-fork.html#var-reads"><div class="inner"><span>reads</span></div></a></li><li class="depth-1"><a href="jepsen.tests.long-fork.html#var-workload"><div class="inner"><span>workload</span></div></a></li><li class="depth-1"><a href="jepsen.tests.long-fork.html#var-write-txn.3F"><div class="inner"><span>write-txn?</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">jepsen.tests.long-fork</h1><div class="doc"><div class="markdown"><p>Tests for an anomaly in parallel snapshot isolation (but which is prohibited in normal snapshot isolation). In long-fork, concurrent write transactions are observed in conflicting order. For example:</p>
<p>T1: (write x 1) T2: (write y 1) T3: (read x nil) (read y 1) T4: (read x 1) (read y nil)</p>
<p>T3 implies T2 &lt; T1, but T4 implies T1 &lt; T2. We aim to observe these conflicts.</p>
<p>To generalize to multiple updates…</p>
<p>Let a write transaction be a transaction of the form <a href="(write k v)">(write k v)</a>, executing a single write to a single register. Assume no two write transactions have the same key <em>and</em> value.</p>
<p>Let a read transaction be a transaction of the form <a href="(read k1 v1) (read k2
v2) ...">(read k1 v1) (read k2 v2) …</a>, reading multiple distinct registers.</p>
<p>Let R be a set of reads, and W be a set of writes. Let the total set of transactions T = R U W; e.g. there are only reads and writes. Let the initial state be empty.</p>
<p>Serializability implies that there should exist an order &lt; over T, such that every read observes the state of the system as given by the prefix of all write transactions up to some point t_i.</p>
<p>Since each value is written exactly once, a sequence of states with the same value for a key k must be <em>contiguous</em> in this order. That is, it would be illegal to read:</p>
<pre><code>[(r x 0)] [(r x 1)] [(r x 0)]
</code></pre>
<p>… because although we can infer (w x 0) happened before t1, and (w x 1) happened between t2, there is no <em>second</em> (w x 0) that can satisfy t3. Visually, imagine bars which connect identical values from reads, keeping them together:</p>
<pre><code>key   r1    r2    r3    r4

x     0     1 --- 1 --- 1

y     0     1 --- 1     0

z     0 --- 0     2     1
</code></pre>
<p>A long fork anomaly manifests when we cannot construct an order where these bars connect identical values into contiguous blocks.</p>
<p>Note that more than one value may change between reads: we may not observe every change.</p>
<p>Note that the values for a given key are not monotonic; we must treat them as unordered, opaque values because the serialization order of writes is (in general) arbitrary. It would be easier if we knew the write order up front. The classic example of long fork uses inserts because we know the states go from <code>nil</code> to <code>some-value</code>, but in our case, it could be 0 -&gt; 1, or 1 -&gt; 0.</p>
<p>To build a graph like this, we need an incremental process. We know the initial state was <a href="nil nil nil ...">nil nil nil …</a>, so we can start there. Let our sequence be:</p>
<pre><code>    r0

x   nil
y   nil
z   nil
</code></pre>
<p>We know that values can only change <em>away</em> from nil. This implies that those reads with the most nils must come adjacent to r0. In general, if there exists a read r1 adjacent to r0, then there must not exist any read r2 such that r2 has more in common with r0 than r1. This assumes that all reads are total.</p>
<p>Additionally, if the graph is to be… smooth, as opposed to forking, there are only two directions to travel from any given read. This implies there can be at most two reads r1 and r2 with an equal number of links <em>and</em> distinct links to r0. If a third read with this property exists, there’s ‘nowhere to put it’ without creating a fork.</p>
<p>We can verify this property in roughly linear time, which is nice. It doesn’t, however, prevent <em>closed loops</em> with no forking structure.</p>
<p>To do loops, I think we have to actually do the graph traversal. Let’s punt on that for now.</p>
</div></div><div class="public anchor" id="var-checker"><h3>checker</h3><div class="usage"><code>(checker n)</code></div><div class="doc"><div class="markdown"><p>Takes a group size n, and a history of :txn transactions. Verifies that no key is written multiple times. Searches for read transactions where one read observes x but not y, and another observes y but not x.</p>
</div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/v0.3.7/jepsen/src/jepsen/tests/long_fork.clj#L311">view source</a></div></div><div class="public anchor" id="var-distinct-pairs"><h3>distinct-pairs</h3><div class="usage"><code>(distinct-pairs coll)</code></div><div class="doc"><div class="markdown"><p>Given a collection, returns a sequence of all unique 2-element sets taken from that collection.</p>
</div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/v0.3.7/jepsen/src/jepsen/tests/long_fork.clj#L208">view source</a></div></div><div class="public anchor" id="var-early-reads"><h3>early-reads</h3><div class="usage"><code>(early-reads reads)</code></div><div class="doc"><div class="markdown"><p>Given a set of read txns finds those that are too early to tell us anything; e.g. all nil</p>
</div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/v0.3.7/jepsen/src/jepsen/tests/long_fork.clj#L297">view source</a></div></div><div class="public anchor" id="var-ensure-no-long-forks"><h3>ensure-no-long-forks</h3><div class="usage"><code>(ensure-no-long-forks n reads)</code></div><div class="doc"><div class="markdown"><p>Returns a checker error if any long forks exist.</p>
</div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/v0.3.7/jepsen/src/jepsen/tests/long_fork.clj#L263">view source</a></div></div><div class="public anchor" id="var-ensure-no-multiple-writes-to-one-key"><h3>ensure-no-multiple-writes-to-one-key</h3><div class="usage"><code>(ensure-no-multiple-writes-to-one-key history)</code></div><div class="doc"><div class="markdown"><p>Returns a checker error if we have multiple writes to one key, or nil if things are OK.</p>
</div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/v0.3.7/jepsen/src/jepsen/tests/long_fork.clj#L273">view source</a></div></div><div class="public anchor" id="var-find-forks"><h3>find-forks</h3><div class="usage"><code>(find-forks ops)</code></div><div class="doc"><div class="markdown"><p>Given a set of read ops, compares every one to ensure a total order exists. If mutually incomparable reads exist, returns the pair.</p>
</div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/v0.3.7/jepsen/src/jepsen/tests/long_fork.clj#L216">view source</a></div></div><div class="public anchor" id="var-generator"><h3>generator</h3><div class="usage"><code>(generator n)</code></div><div class="doc"><div class="markdown"><p>Generates single inserts followed by group reads, mixed with reads of other concurrent groups, just for grins. Takes a group size n.</p>
</div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/v0.3.7/jepsen/src/jepsen/tests/long_fork.clj#L152">view source</a></div></div><div class="public anchor" id="var-group-for"><h3>group-for</h3><div class="usage"><code>(group-for n k)</code></div><div class="doc"><div class="markdown"><p>Takes a key and returns the collection of keys for its group. Lower inclusive, upper exclusive.</p>
</div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/v0.3.7/jepsen/src/jepsen/tests/long_fork.clj#L97">view source</a></div></div><div class="public anchor" id="var-groups"><h3>groups</h3><div class="usage"><code>(groups n read-ops)</code></div><div class="doc"><div class="markdown"><p>Given a group size n, and a set of read ops, partitions those read operations by group. Throws if any group has the wrong size.</p>
</div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/v0.3.7/jepsen/src/jepsen/tests/long_fork.clj#L248">view source</a></div></div><div class="public anchor" id="var-late-reads"><h3>late-reads</h3><div class="usage"><code>(late-reads reads)</code></div><div class="doc"><div class="markdown"><p>Given a set of read txns, finds those that are too late to tell us anything; e.g. all 1.</p>
</div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/v0.3.7/jepsen/src/jepsen/tests/long_fork.clj#L304">view source</a></div></div><div class="public anchor" id="var-legal-txn.3F"><h3>legal-txn?</h3><div class="usage"><code>(legal-txn? txn)</code></div><div class="doc"><div class="markdown"><p>Checks to ensure a txn is legal.</p>
</div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/v0.3.7/jepsen/src/jepsen/tests/long_fork.clj#L237">view source</a></div></div><div class="public anchor" id="var-op-read-keys"><h3>op-read-keys</h3><div class="usage"><code>(op-read-keys op)</code></div><div class="doc"><div class="markdown"><p>Given a read op, returns the set of keys read.</p>
</div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/v0.3.7/jepsen/src/jepsen/tests/long_fork.clj#L243">view source</a></div></div><div class="public anchor" id="var-read-compare"><h3>read-compare</h3><div class="usage"><code>(read-compare a b)</code></div><div class="doc"><div class="markdown"><p>Given two maps of keys to values, a and b, returns -1 if a dominates, 0 if the two are equal, 1 if b dominates, or nil if a and b are incomparable.</p>
</div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/v0.3.7/jepsen/src/jepsen/tests/long_fork.clj#L158">view source</a></div></div><div class="public anchor" id="var-read-op-.3Evalue-map"><h3>read-op-&gt;value-map</h3><div class="usage"><code>(read-op-&gt;value-map op)</code></div><div class="doc"><div class="markdown"><p>Takes a read operation, and converts it to a map of keys to values.</p>
</div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/v0.3.7/jepsen/src/jepsen/tests/long_fork.clj#L198">view source</a></div></div><div class="public anchor" id="var-read-txn-for"><h3>read-txn-for</h3><div class="usage"><code>(read-txn-for n k)</code></div><div class="doc"><div class="markdown"><p>Takes a group size and a key and generates a transaction reading that key’s group in shuffled order.</p>
</div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/v0.3.7/jepsen/src/jepsen/tests/long_fork.clj#L106">view source</a></div></div><div class="public anchor" id="var-read-txn.3F"><h3>read-txn?</h3><div class="usage"><code>(read-txn? txn)</code></div><div class="doc"><div class="markdown"><p>Is this transaction a pure read txn?</p>
</div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/v0.3.7/jepsen/src/jepsen/tests/long_fork.clj#L226">view source</a></div></div><div class="public anchor" id="var-reads"><h3>reads</h3><div class="usage"><code>(reads history)</code></div><div class="doc"><div class="markdown"><p>All ok read ops</p>
</div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/v0.3.7/jepsen/src/jepsen/tests/long_fork.clj#L290">view source</a></div></div><div class="public anchor" id="var-workload"><h3>workload</h3><div class="usage"><code>(workload)</code><code>(workload n)</code></div><div class="doc"><div class="markdown"><p>A package of a checker and generator to look for long forks. n is the group size: how many keys to check simultaneously.</p>
</div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/v0.3.7/jepsen/src/jepsen/tests/long_fork.clj#L326">view source</a></div></div><div class="public anchor" id="var-write-txn.3F"><h3>write-txn?</h3><div class="usage"><code>(write-txn? txn)</code></div><div class="doc"><div class="markdown"><p>Is this a pure write transaction?</p>
</div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/v0.3.7/jepsen/src/jepsen/tests/long_fork.clj#L231">view source</a></div></div></div></body></html>